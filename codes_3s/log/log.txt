Global seed set to 42
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
2024-12-17 07:23:22.421984: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-12-17 07:23:22.571890: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-12-17 07:23:23.111168: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64
2024-12-17 07:23:23.111273: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/nvidia/lib:/usr/local/nvidia/lib64
2024-12-17 07:23:23.111284: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.

  | Name          | Type           | Params
-------------------------------------------------
0 | encoder_eeg   | SampleCNN2DEEG | 130 K 
1 | encoder_audio | SampleCNN2DEEG | 130 K 
2 | criterion     | PredANN_Loss   | 0     
-------------------------------------------------
260 K     Trainable params
0         Non-trainable params
260 K     Total params
1.041     Total estimated model params size (MB)
no augmentation
check
Size of train dataset: 1200
Size of valid dataset: 5600
EEG Contrastive learning
use PredANN_loss as criterion
[[[ START ]]] 2024-12-17 07:23:20.731914
Validation sanity check: 0it [00:00, ?it/s]Validation sanity check:   0%|          | 0/2 [00:00<?, ?it/s]Validation sanity check:  50%|█████     | 1/2 [00:01<00:01,  1.46s/it]                                                                      Global seed set to 42
Training: -1it [00:00, ?it/s]Training:   0%|          | 0/600 [00:00<00:00, 15477.14it/s]Epoch 0:   0%|          | 0/600 [00:00<00:00, 3266.59it/s]  Epoch 0:   0%|          | 1/600 [00:01<05:18,  1.88it/s]  Epoch 0:   0%|          | 1/600 [00:01<05:18,  1.88it/s, loss=4.82, v_num=4]Epoch 0:   0%|          | 2/600 [00:01<04:03,  2.46it/s, loss=4.82, v_num=4]Epoch 0:   0%|          | 2/600 [00:01<04:03,  2.46it/s, loss=4.71, v_num=4]Epoch 0:   0%|          | 3/600 [00:01<03:23,  2.93it/s, loss=4.71, v_num=4]Epoch 0:   0%|          | 3/600 [00:01<03:23,  2.93it/s, loss=4.55, v_num=4]Epoch 0:   1%|          | 4/600 [00:01<02:58,  3.34it/s, loss=4.55, v_num=4]Epoch 0:   1%|          | 4/600 [00:01<02:58,  3.34it/s, loss=4.64, v_num=4]Epoch 0:   1%|          | 5/600 [00:01<02:42,  3.66it/s, loss=4.64, v_num=4]Epoch 0:   1%|          | 5/600 [00:01<02:42,  3.66it/s, loss=4.68, v_num=4]Epoch 0:   1%|          | 6/600 [00:01<02:30,  3.95it/s, loss=4.68, v_num=4]Epoch 0:   1%|          | 6/600 [00:01<02:30,  3.95it/s, loss=4.55, v_num=4]Epoch 0:   1%|          | 7/600 [00:01<02:21,  4.20it/s, loss=4.55, v_num=4]Epoch 0:   1%|          | 7/600 [00:01<02:21,  4.20it/s, loss=4.55, v_num=4]Epoch 0:   1%|▏         | 8/600 [00:02<02:14,  4.40it/s, loss=4.55, v_num=4]Epoch 0:   1%|▏         | 8/600 [00:02<02:14,  4.40it/s, loss=4.65, v_num=4]Epoch 0:   2%|▏         | 9/600 [00:02<02:08,  4.59it/s, loss=4.65, v_num=4]Epoch 0:   2%|▏         | 9/600 [00:02<02:08,  4.58it/s, loss=4.77, v_num=4]Epoch 0:   2%|▏         | 10/600 [00:02<02:03,  4.76it/s, loss=4.77, v_num=4]Epoch 0:   2%|▏         | 10/600 [00:02<02:03,  4.76it/s, loss=4.81, v_num=4]Epoch 0:   2%|▏         | 11/600 [00:02<01:59,  4.92it/s, loss=4.81, v_num=4]Epoch 0:   2%|▏         | 11/600 [00:02<01:59,  4.92it/s, loss=4.89, v_num=4]Epoch 0:   2%|▏         | 12/600 [00:02<01:56,  5.05it/s, loss=4.89, v_num=4]Epoch 0:   2%|▏         | 12/600 [00:02<01:56,  5.05it/s, loss=4.91, v_num=4]Epoch 0:   2%|▏         | 13/600 [00:02<01:53,  5.17it/s, loss=4.91, v_num=4]Epoch 0:   2%|▏         | 13/600 [00:02<01:53,  5.17it/s, loss=4.83, v_num=4]Epoch 0:   2%|▏         | 14/600 [00:02<01:50,  5.30it/s, loss=4.83, v_num=4]Epoch 0:   2%|▏         | 14/600 [00:02<01:50,  5.29it/s, loss=4.95, v_num=4]Epoch 0:   2%|▎         | 15/600 [00:02<01:48,  5.39it/s, loss=4.95, v_num=4]Epoch 0:   2%|▎         | 15/600 [00:02<01:48,  5.38it/s, loss=4.83, v_num=4]Epoch 0:   3%|▎         | 16/600 [00:03<01:46,  5.48it/s, loss=4.83, v_num=4]Epoch 0:   3%|▎         | 16/600 [00:03<01:46,  5.48it/s, loss=4.95, v_num=4]Epoch 0:   3%|▎         | 17/600 [00:03<01:44,  5.57it/s, loss=4.95, v_num=4]Epoch 0:   3%|▎         | 17/600 [00:03<01:44,  5.57it/s, loss=4.9, v_num=4] Epoch 0:   3%|▎         | 18/600 [00:03<01:43,  5.64it/s, loss=4.9, v_num=4]Epoch 0:   3%|▎         | 18/600 [00:03<01:43,  5.64it/s, loss=4.93, v_num=4]Epoch 0:   3%|▎         | 19/600 [00:03<01:41,  5.72it/s, loss=4.93, v_num=4]Epoch 0:   3%|▎         | 19/600 [00:03<01:41,  5.72it/s, loss=5.05, v_num=4]Epoch 0:   3%|▎         | 20/600 [00:03<01:40,  5.79it/s, loss=5.05, v_num=4]Epoch 0:   3%|▎         | 20/600 [00:03<01:40,  5.79it/s, loss=5.08, v_num=4]Epoch 0:   4%|▎         | 21/600 [00:03<01:38,  5.86it/s, loss=5.08, v_num=4]Epoch 0:   4%|▎         | 21/600 [00:03<01:38,  5.86it/s, loss=5.13, v_num=4]Epoch 0:   4%|▎         | 22/600 [00:03<01:37,  5.92it/s, loss=5.13, v_num=4]Epoch 0:   4%|▎         | 22/600 [00:03<01:37,  5.92it/s, loss=5.1, v_num=4] Epoch 0:   4%|▍         | 23/600 [00:04<01:36,  5.96it/s, loss=5.1, v_num=4]Epoch 0:   4%|▍         | 23/600 [00:04<01:36,  5.96it/s, loss=5.14, v_num=4]Epoch 0:   4%|▍         | 24/600 [00:04<01:35,  6.02it/s, loss=5.14, v_num=4]Epoch 0:   4%|▍         | 24/600 [00:04<01:35,  6.02it/s, loss=5.15, v_num=4]Epoch 0:   4%|▍         | 25/600 [00:04<01:34,  6.07it/s, loss=5.15, v_num=4]Epoch 0:   4%|▍         | 25/600 [00:04<01:34,  6.07it/s, loss=5.08, v_num=4]Epoch 0:   4%|▍         | 26/600 [00:04<01:33,  6.11it/s, loss=5.08, v_num=4]Epoch 0:   4%|▍         | 26/600 [00:04<01:33,  6.11it/s, loss=5.16, v_num=4]Epoch 0:   4%|▍         | 27/600 [00:04<01:33,  6.16it/s, loss=5.16, v_num=4]Epoch 0:   4%|▍         | 27/600 [00:04<01:33,  6.16it/s, loss=5.14, v_num=4]Epoch 0:   5%|▍         | 28/600 [00:04<01:32,  6.20it/s, loss=5.14, v_num=4]Epoch 0:   5%|▍         | 28/600 [00:04<01:32,  6.20it/s, loss=5.09, v_num=4]Epoch 0:   5%|▍         | 29/600 [00:04<01:31,  6.23it/s, loss=5.09, v_num=4]Epoch 0:   5%|▍         | 29/600 [00:04<01:31,  6.23it/s, loss=5.1, v_num=4] Epoch 0:   5%|▌         | 30/600 [00:04<01:30,  6.27it/s, loss=5.1, v_num=4]Epoch 0:   5%|▌         | 30/600 [00:04<01:30,  6.27it/s, loss=5.1, v_num=4]Epoch 0:   5%|▌         | 31/600 [00:05<01:30,  6.30it/s, loss=5.1, v_num=4]Epoch 0:   5%|▌         | 31/600 [00:05<01:30,  6.30it/s, loss=5.06, v_num=4]Epoch 0:   5%|▌         | 32/600 [00:05<01:29,  6.34it/s, loss=5.06, v_num=4]Epoch 0:   5%|▌         | 32/600 [00:05<01:29,  6.34it/s, loss=5.04, v_num=4]Epoch 0:   6%|▌         | 33/600 [00:05<01:29,  6.36it/s, loss=5.04, v_num=4]Epoch 0:   6%|▌         | 33/600 [00:05<01:29,  6.36it/s, loss=5.14, v_num=4]Epoch 0:   6%|▌         | 34/600 [00:05<01:28,  6.39it/s, loss=5.14, v_num=4]Epoch 0:   6%|▌         | 34/600 [00:05<01:28,  6.39it/s, loss=5.09, v_num=4]Epoch 0:   6%|▌         | 35/600 [00:05<01:27,  6.42it/s, loss=5.09, v_num=4]Epoch 0:   6%|▌         | 35/600 [00:05<01:28,  6.42it/s, loss=5.22, v_num=4]Epoch 0:   6%|▌         | 36/600 [00:05<01:27,  6.45it/s, loss=5.22, v_num=4]Epoch 0:   6%|▌         | 36/600 [00:05<01:27,  6.45it/s, loss=5.15, v_num=4]Epoch 0:   6%|▌         | 37/600 [00:05<01:26,  6.48it/s, loss=5.15, v_num=4]Epoch 0:   6%|▌         | 37/600 [00:05<01:26,  6.48it/s, loss=5.18, v_num=4]Epoch 0:   6%|▋         | 38/600 [00:05<01:26,  6.51it/s, loss=5.18, v_num=4]Epoch 0:   6%|▋         | 38/600 [00:05<01:26,  6.50it/s, loss=5.15, v_num=4]Epoch 0:   6%|▋         | 39/600 [00:06<01:25,  6.52it/s, loss=5.15, v_num=4]Epoch 0:   6%|▋         | 39/600 [00:06<01:26,  6.52it/s, loss=5, v_num=4]   Epoch 0:   7%|▋         | 40/600 [00:06<01:25,  6.55it/s, loss=5, v_num=4]Epoch 0:   7%|▋         | 40/600 [00:06<01:25,  6.55it/s, loss=4.97, v_num=4]Epoch 0:   7%|▋         | 41/600 [00:06<01:25,  6.57it/s, loss=4.97, v_num=4]Epoch 0:   7%|▋         | 41/600 [00:06<01:25,  6.57it/s, loss=4.86, v_num=4]Epoch 0:   7%|▋         | 42/600 [00:06<01:24,  6.59it/s, loss=4.86, v_num=4]Epoch 0:   7%|▋         | 42/600 [00:06<01:24,  6.59it/s, loss=4.91, v_num=4]Epoch 0:   7%|▋         | 43/600 [00:06<01:24,  6.61it/s, loss=4.91, v_num=4]Epoch 0:   7%|▋         | 43/600 [00:06<01:24,  6.61it/s, loss=4.87, v_num=4]Epoch 0:   7%|▋         | 44/600 [00:06<01:23,  6.63it/s, loss=4.87, v_num=4]Epoch 0:   7%|▋         | 44/600 [00:06<01:23,  6.63it/s, loss=4.85, v_num=4]Epoch 0:   8%|▊         | 45/600 [00:06<01:23,  6.64it/s, loss=4.85, v_num=4]Epoch 0:   8%|▊         | 45/600 [00:06<01:23,  6.64it/s, loss=4.92, v_num=4]Epoch 0:   8%|▊         | 46/600 [00:07<01:23,  6.66it/s, loss=4.92, v_num=4]Epoch 0:   8%|▊         | 46/600 [00:07<01:23,  6.66it/s, loss=4.85, v_num=4]Epoch 0:   8%|▊         | 47/600 [00:07<01:22,  6.67it/s, loss=4.85, v_num=4]Epoch 0:   8%|▊         | 47/600 [00:07<01:22,  6.67it/s, loss=4.87, v_num=4]Epoch 0:   8%|▊         | 48/600 [00:07<01:22,  6.68it/s, loss=4.87, v_num=4]Epoch 0:   8%|▊         | 48/600 [00:07<01:22,  6.68it/s, loss=4.86, v_num=4]Epoch 0:   8%|▊         | 49/600 [00:07<01:22,  6.70it/s, loss=4.86, v_num=4]Epoch 0:   8%|▊         | 49/600 [00:07<01:22,  6.70it/s, loss=4.78, v_num=4]Epoch 0:   8%|▊         | 50/600 [00:07<01:21,  6.72it/s, loss=4.78, v_num=4]Epoch 0:   8%|▊         | 50/600 [00:07<01:21,  6.72it/s, loss=4.75, v_num=4]Epoch 0:   8%|▊         | 51/600 [00:07<01:21,  6.73it/s, loss=4.75, v_num=4]Epoch 0:   8%|▊         | 51/600 [00:07<01:21,  6.73it/s, loss=4.7, v_num=4] Epoch 0:   9%|▊         | 52/600 [00:07<01:21,  6.75it/s, loss=4.7, v_num=4]Epoch 0:   9%|▊         | 52/600 [00:07<01:21,  6.75it/s, loss=4.71, v_num=4]Epoch 0:   9%|▉         | 53/600 [00:07<01:20,  6.76it/s, loss=4.71, v_num=4]Epoch 0:   9%|▉         | 53/600 [00:07<01:20,  6.76it/s, loss=4.64, v_num=4]Epoch 0:   9%|▉         | 54/600 [00:08<01:20,  6.77it/s, loss=4.64, v_num=4]Epoch 0:   9%|▉         | 54/600 [00:08<01:20,  6.77it/s, loss=4.53, v_num=4]Epoch 0:   9%|▉         | 55/600 [00:08<01:20,  6.78it/s, loss=4.53, v_num=4]Epoch 0:   9%|▉         | 55/600 [00:08<01:20,  6.78it/s, loss=4.47, v_num=4]Epoch 0:   9%|▉         | 56/600 [00:08<01:20,  6.80it/s, loss=4.47, v_num=4]Epoch 0:   9%|▉         | 56/600 [00:08<01:20,  6.80it/s, loss=4.45, v_num=4]Epoch 0:  10%|▉         | 57/600 [00:08<01:19,  6.81it/s, loss=4.45, v_num=4]Epoch 0:  10%|▉         | 57/600 [00:08<01:19,  6.81it/s, loss=4.47, v_num=4]Epoch 0:  10%|▉         | 58/600 [00:08<01:19,  6.82it/s, loss=4.47, v_num=4]Epoch 0:  10%|▉         | 58/600 [00:08<01:19,  6.82it/s, loss=4.44, v_num=4]Epoch 0:  10%|▉         | 59/600 [00:08<01:19,  6.83it/s, loss=4.44, v_num=4]Epoch 0:  10%|▉         | 59/600 [00:08<01:19,  6.83it/s, loss=4.5, v_num=4] Epoch 0:  10%|█         | 60/600 [00:08<01:19,  6.83it/s, loss=4.5, v_num=4]Epoch 0:  10%|█         | 60/600 [00:08<01:19,  6.83it/s, loss=4.45, v_num=4]Epoch 0:  10%|█         | 61/600 [00:09<01:18,  6.85it/s, loss=4.45, v_num=4]Epoch 0:  10%|█         | 61/600 [00:09<01:18,  6.84it/s, loss=4.48, v_num=4]Epoch 0:  10%|█         | 62/600 [00:09<01:18,  6.85it/s, loss=4.48, v_num=4]Epoch 0:  10%|█         | 62/600 [00:09<01:18,  6.85it/s, loss=4.54, v_num=4]Epoch 0:  10%|█         | 63/600 [00:09<01:18,  6.86it/s, loss=4.54, v_num=4]Epoch 0:  10%|█         | 63/600 [00:09<01:18,  6.86it/s, loss=4.51, v_num=4]Epoch 0:  11%|█         | 64/600 [00:09<01:18,  6.86it/s, loss=4.51, v_num=4]Epoch 0:  11%|█         | 64/600 [00:09<01:18,  6.86it/s, loss=4.52, v_num=4]Epoch 0:  11%|█         | 65/600 [00:09<01:17,  6.87it/s, loss=4.52, v_num=4]Epoch 0:  11%|█         | 65/600 [00:09<01:17,  6.87it/s, loss=4.5, v_num=4] Epoch 0:  11%|█         | 66/600 [00:09<01:17,  6.88it/s, loss=4.5, v_num=4]Epoch 0:  11%|█         | 66/600 [00:09<01:17,  6.88it/s, loss=4.55, v_num=4]Epoch 0:  11%|█         | 67/600 [00:09<01:17,  6.89it/s, loss=4.55, v_num=4]Epoch 0:  11%|█         | 67/600 [00:09<01:17,  6.89it/s, loss=4.54, v_num=4]Epoch 0:  11%|█▏        | 68/600 [00:10<01:17,  6.89it/s, loss=4.54, v_num=4]Epoch 0:  11%|█▏        | 68/600 [00:10<01:17,  6.89it/s, loss=4.59, v_num=4]Epoch 0:  12%|█▏        | 69/600 [00:10<01:16,  6.90it/s, loss=4.59, v_num=4]Epoch 0:  12%|█▏        | 69/600 [00:10<01:16,  6.90it/s, loss=4.57, v_num=4]Epoch 0:  12%|█▏        | 70/600 [00:10<01:16,  6.90it/s, loss=4.57, v_num=4]Epoch 0:  12%|█▏        | 70/600 [00:10<01:16,  6.90it/s, loss=4.63, v_num=4]Epoch 0:  12%|█▏        | 71/600 [00:10<01:16,  6.91it/s, loss=4.63, v_num=4]Epoch 0:  12%|█▏        | 71/600 [00:10<01:16,  6.91it/s, loss=4.65, v_num=4]